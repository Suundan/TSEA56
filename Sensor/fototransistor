/*
 * distance_foto.c
 *
 * Created: 2016-04-15 09:07:07
 * Author : Milton
 */ 

#include <avr/io.h>
#include <avr/interrupt.h>
#include <avr/delay.h>
uint16_t distance_foto = 0x00;
int main(void)
{
	DDRA = 0b00000000;	//Sets all A-pins as inputs
	ADMUX=0x60;			//Leftshift the output from the ad-converter (reads from ADCH) and sets A0 as input
	ADCSRA=0x83;		//Sets up the ad-converter to enable and prescale with 8
	DDRB = 0xff;		// Sets all B-pins to outputs
	PORTB= 0x00;		// Initialize the B-port to ceros
	ADCSRA |= (1<<ADSC);// Start the conversion
    while (ADCSRA |= (1<<ADSC)) 
    {
		_delay_ms(5);
		while(ADCH < 0x60){
			ADCSRA |= (1<<ADSC);//Check if it is black
		}
		_delay_ms(5);
		while(ADCH > 0x96){
			ADCSRA |= (1<<ADSC);//Check if it is white
		}
		++distance_foto; //If it had been black and white after eachother and the other way around it counts 
		//PORTB = distance_foto;
		
	}
}
